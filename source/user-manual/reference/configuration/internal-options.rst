.. _reference_internal_options:

Internal options
===================

The main configuration is located in the *ossec.conf* file, however some internal configuration features are located in the ``/var/ossec/etc/internal_options.conf`` file.

Generally, this file is reserved for debugging issues and for troubleshooting. **Any error in this file may cause your installation to malfunction or fail to run.**

.. warning::
    This file will be overwritten during upgrades.  In order to maintain custom changes, you must use the ``/var/ossec/etc/local_internal_options.conf`` file.

- `Agent`_
- `Analysisd`_
- `DBD`_
- `Logcollector`_
- `Maild`_
- `Monitord`_
- `Remoted`_
- `Syscheck`_
- `Wazuh_database`_
- `Wazuh_modules`_
- `Windows`_


Agent
-----

+-----------------+----------------+------------------------------------------+
| **agent.debug** | Description    | Run the agentâ€™s processes in debug mode. |
+                 +----------------+------------------------------------------+
|                 | Default Value  | 0                                        |
+                 +----------------+------------------------------------------+
|                 | Allowed Value  | 0 : No debug output                      |
+                 +                +------------------------------------------+
|                 |                | 1: Standard debug output                 |
+                 +                +------------------------------------------+
|                 |                | 2: Verbose debug outputNext,Previous     |
+-----------------+----------------+------------------------------------------+

Analysisd
---------
+------------------------------------+---------------+--------------------------------------------------------------------+
|   **analysisd.default_timeframe**  | Description   | Analysisd default rule timeframe.                                  |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Default Value | 360                                                                |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Allowed Value | Any integer                                                        |
+------------------------------------+---------------+--------------------------------------------------------------------+
|     **analysisd.stats_maxdiff**    | Description   | Analysisd stats maximum diff.                                      |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Default Value | 999000                                                             |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Allowed Value | Any integer                                                        |
+------------------------------------+---------------+--------------------------------------------------------------------+
|     **analysisd.stats_mindiff**    | Description   | Analysisd stats minimum diff.                                      |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Default Value | 1250                                                               |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Allowed Value | Any integer                                                        |
+------------------------------------+---------------+--------------------------------------------------------------------+
|  **analysisd.stats_percent_diff**  | Description   | Analysisd stats percentage (how much to differ from average).      |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Default Value | 150                                                                |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Allowed Value | Any integer                                                        |
+------------------------------------+---------------+--------------------------------------------------------------------+
|     **analysisd.fts_list_size**    | Description   | Analysisd FTS list size.                                           |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Default Value | 32                                                                 |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Allowed Value | Any integer                                                        |
+------------------------------------+---------------+--------------------------------------------------------------------+
| **analysisd.fts_min_size_for_str** | Description   | Analysisd FTS minimum string size.                                 |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Default Value | 14                                                                 |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Allowed Value | Any integer                                                        |
+------------------------------------+---------------+--------------------------------------------------------------------+
|        **analysisd.log_fw**        | Description   | Analysisd Enable the firewall log (at logs/firewall/firewall.log). |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Default Value | 1                                                                  |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Allowed Value | 0, 1                                                               |
+------------------------------------+---------------+--------------------------------------------------------------------+
|  **analysisd.decoder_order_size**  | Description   | Maximum number of fields in a decoder (order tag).                 |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Default Value | 64                                                                 |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Allowed Value | Any integer                                                        |
+------------------------------------+---------------+--------------------------------------------------------------------+
|     **analysisd.geoip_jsonout**    | Description   | Output GeoIP data at JSON alerts.                                  |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Default Value | 0                                                                  |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Allowed Value | 0, 1                                                               |
+------------------------------------+---------------+--------------------------------------------------------------------+
|         **analysisd.debug**        | Description   | Debug level (in server or local installations).                    |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Default Value | 0                                                                  |
+                                    +---------------+--------------------------------------------------------------------+
|                                    | Allowed Value | 0: No debug output                                                 |
+                                    +               +--------------------------------------------------------------------+
|                                    |               | 1: Standard debug output                                           |
+                                    +               +--------------------------------------------------------------------+
|                                    |               | 2: Verbose debug output                                            |
+------------------------------------+---------------+--------------------------------------------------------------------+

DBD
---

+----------------------------+---------------+--------------------------------------------------------------------------+
| **dbd.reconnect_attempts** | Description   | The number of times ossec-dbd will attempt to reconnect to the database. |
+                            +---------------+--------------------------------------------------------------------------+
|                            | Default Value | 10                                                                       |
+                            +---------------+--------------------------------------------------------------------------+
|                            | Allowed Value | Any integer                                                              |
+----------------------------+---------------+--------------------------------------------------------------------------+


Logcollector
------------

+----------------------------------+---------------+----------------------------------------------------------------------------+
|   **logcollector.loop_timeout**  | Description   | File polling interval.                                                     |
+                                  +---------------+----------------------------------------------------------------------------+
|                                  | Default Value | 2                                                                          |
+                                  +---------------+----------------------------------------------------------------------------+
|                                  | Allowed Value | Any integer, time in seconds                                               |
+----------------------------------+---------------+----------------------------------------------------------------------------+
|  **logcollector.open_attempts**  | Description   | Number of attempts to open a log file.                                     |
+                                  +---------------+----------------------------------------------------------------------------+
|                                  | Default Value | 8                                                                          |
+                                  +---------------+----------------------------------------------------------------------------+
|                                  | Allowed Value | Any integer                                                                |
+----------------------------------+---------------+----------------------------------------------------------------------------+
| **logcollector.remote_commands** | Description   | enable/disable Logcollector to accept remote commands from the manager.    |
+                                  +---------------+----------------------------------------------------------------------------+
|                                  | Default Value | 0                                                                          |
+                                  +---------------+----------------------------------------------------------------------------+
|                                  | Allowed Value | 0, 1                                                                       |
+----------------------------------+---------------+----------------------------------------------------------------------------+
|   **logcollector.vcheck_files**  | Description   | Number of readings before checking files.                                  |
+                                  +---------------+----------------------------------------------------------------------------+
|                                  | Default Value | 64                                                                         |
+                                  +---------------+----------------------------------------------------------------------------+
|                                  | Allowed Value | Any integer                                                                |
+----------------------------------+---------------+----------------------------------------------------------------------------+
|      **logcollector.debug**      | Description   | Debug level                                                                |
+                                  +---------------+----------------------------------------------------------------------------+
|                                  | Default Value | 0                                                                          |
+                                  +---------------+----------------------------------------------------------------------------+
|                                  | Allowed Value | 0: No debug output                                                         |
+                                  +               +----------------------------------------------------------------------------+
|                                  |               | 1: Standard debug output                                                   |
+                                  +               +----------------------------------------------------------------------------+
|                                  |               | 2: Verbose debug output                                                    |
+----------------------------------+---------------+----------------------------------------------------------------------------+

Maild
-----

+---------------------------+---------------+---------------------------------------------------------------------+
| **maild.strict_checking** | Description   | Toggle to enable or disable strict checking.                        |
+                           +---------------+---------------------------------------------------------------------+
|                           | Default Value | 1                                                                   |
+                           +---------------+---------------------------------------------------------------------+
|                           | Allowed Value | 0, 1                                                                |
+---------------------------+---------------+---------------------------------------------------------------------+
|    **maild.groupping**    | Description   | Toggle to enable or disable grouping of alerts into a single email. |
+                           +---------------+---------------------------------------------------------------------+
|                           | Default Value | 1                                                                   |
+                           +---------------+---------------------------------------------------------------------+
|                           | Allowed Value | 0, 1                                                                |
+---------------------------+---------------+---------------------------------------------------------------------+
|   **maild.full_subject**  | Description   | Toggle to enable or disable full subject in alert emails.           |
+                           +---------------+---------------------------------------------------------------------+
|                           | Default Value | 0                                                                   |
+                           +---------------+---------------------------------------------------------------------+
|                           | Allowed Value | 0, 1                                                                |
+---------------------------+---------------+---------------------------------------------------------------------+
|      **maild.geoip**      | Description   | Toggle to enable or disable GeoIP data in alert emails.             |
+                           +---------------+---------------------------------------------------------------------+
|                           | Default Value | 1                                                                   |
+                           +---------------+---------------------------------------------------------------------+
|                           | Allowed Value | 0, 1                                                                |
+---------------------------+---------------+---------------------------------------------------------------------+

Monitord
--------

+-----------------------------+---------------+--------------------------------------------------------------------+
|    **monitord.day_wait**    | Description   | Amount of seconds to wait before compressing or signing the files. |
+                             +---------------+--------------------------------------------------------------------+
|                             | Default Value | 10                                                                 |
+                             +---------------+--------------------------------------------------------------------+
|                             | Allowed Value | Any integer                                                        |
+-----------------------------+---------------+--------------------------------------------------------------------+
|    **monitord.compress**    | Description   | Toggle to enable or disable log file compression.                  |
+                             +---------------+--------------------------------------------------------------------+
|                             | Default Value | 1                                                                  |
+                             +---------------+--------------------------------------------------------------------+
|                             | Allowed Value | 0, 1                                                               |
+-----------------------------+---------------+--------------------------------------------------------------------+
|      **monitord.sign**      | Description   | Toggle to enable or disable signing the log files.                 |
+                             +---------------+--------------------------------------------------------------------+
|                             | Default Value | 1                                                                  |
+                             +---------------+--------------------------------------------------------------------+
|                             | Allowed Value | 0, 1                                                               |
+-----------------------------+---------------+--------------------------------------------------------------------+
| **monitord.monitor_agents** | Description   | Toggle to enable or disable monitoring of agents.                  |
+                             +---------------+--------------------------------------------------------------------+
|                             | Default Value | 1                                                                  |
+                             +---------------+--------------------------------------------------------------------+
|                             | Allowed Value | 0, 1                                                               |
+-----------------------------+---------------+--------------------------------------------------------------------+

Remoted
-------

+-----------------------------------+---------------+--------------------------------------------------------------+
|   **remoted.recv_counter_flush**  | Description   | Flush rate for the receive counter.                          |
+                                   +---------------+--------------------------------------------------------------+
|                                   | Default Value | 128                                                          |
+                                   +---------------+--------------------------------------------------------------+
|                                   | Allowed Value | Any integer                                                  |
+-----------------------------------+---------------+--------------------------------------------------------------+
| **remoted.comp_average_printout** | Description   | Compression averages printout.                               |
+                                   +---------------+--------------------------------------------------------------+
|                                   | Default Value | 19999                                                        |
+                                   +---------------+--------------------------------------------------------------+
|                                   | Allowed Value | Any integer                                                  |
+-----------------------------------+---------------+--------------------------------------------------------------+
|     **remoted.verify_msg_id**     | Description   | Toggle to enable or disable verification of msg id.          |
+                                   +---------------+--------------------------------------------------------------+
|                                   | Default Value | 0                                                            |
+                                   +---------------+--------------------------------------------------------------+
|                                   | Allowed Value | 0, 1                                                         |
+-----------------------------------+---------------+--------------------------------------------------------------+
|   **remoted.pass_empty_keyfile**  | Description   | Toggle to enable or disable acceptance of empty client.keys. |
+                                   +---------------+--------------------------------------------------------------+
|                                   | Default Value | 1                                                            |
+                                   +---------------+--------------------------------------------------------------+
|                                   | Allowed Value | 0, 1                                                         |
+-----------------------------------+---------------+--------------------------------------------------------------+
|         **remoted.debug**         | Description   | Debug level                                                  |
+                                   +---------------+--------------------------------------------------------------+
|                                   | Default Value | 0                                                            |
+                                   +---------------+--------------------------------------------------------------+
|                                   | Allowed Value | 0: No debug output                                           |
+                                   +               +--------------------------------------------------------------+
|                                   |               | 1: Standard debug output                                     |
+                                   +               +--------------------------------------------------------------+
|                                   |               | 2: Verbose debug output                                      |
+-----------------------------------+---------------+--------------------------------------------------------------+


Syscheck
--------

+--------------------------+---------------+--------------------------------------------------------------------------------+
|    **syscheck.sleep**    | Description   | Number of seconds to sleep after reading syscheck.sleep_after number of files. |
+                          +---------------+--------------------------------------------------------------------------------+
|                          | Default Value | 2                                                                              |
+                          +---------------+--------------------------------------------------------------------------------+
|                          | Allowed Value | Any integer                                                                    |
+--------------------------+---------------+--------------------------------------------------------------------------------+
| **syscheck.sleep_after** | Description   |  Number of files to read before sleeping for syscheck.sleep seconds.           |
+                          +---------------+--------------------------------------------------------------------------------+
|                          | Default Value | 15                                                                             |
+                          +---------------+--------------------------------------------------------------------------------+
|                          | Allowed Value | Any integer                                                                    |
+--------------------------+---------------+--------------------------------------------------------------------------------+
|    **syscheck.debug**    | Description   | Debug level (used in local, server and unix agent installations).              |
+                          +---------------+--------------------------------------------------------------------------------+
|                          | Default Value | 0                                                                              |
+                          +---------------+--------------------------------------------------------------------------------+
|                          | Allowed Value | 0: No debug output                                                             |
+                          +               +--------------------------------------------------------------------------------+
|                          |               | 1: Standard debug output                                                       |
+                          +               +--------------------------------------------------------------------------------+
|                          |               | 2: Verbose debug outputNext,Previous                                           |
+--------------------------+---------------+--------------------------------------------------------------------------------+

Wazuh_database
--------------

The Wazuh core uses list-based databases to store information related to agent keys and FIM / Rootcheck event data. Such information is highly optimized to be handled by the core.

In order to provide well-structured data that could be accessed by the user or the Wazuh API, new **SQLite-based databases** have been introduced in the Wazuh manager. The Database Synchronization Module is a **user-transparent component** that collects the following information from the core:

- Agent's name, address, encryption key, last connection time, operating system, agent version and shared configuration hash.
- FIM data: creation, modification and deletion of regular files and Windows registry entries.
- Rootcheck detected defects: issue message, first detection date and last alert time.
- Static core settings, such as maximum permitted agents or SSL being enabled for Authd.

.. note::
    The Wazuh Database Synchronization Module starts automatically on the server and local profiles and requires no configuration, however, some optional settings are available.

The module uses *inotify* from Linux to monitor changes to every log file in real-time. Databases will be updated as soon as possible when a change is detected. **If inotify is not supported**, (for example, on operating systems other than Linux) every log file will be scanned continuously, looking for changes, with a default delay of one minute between scans.

How to disable the module
^^^^^^^^^^^^^^^^^^^^^^^^^

To disable the Wazuh Database Synchronization Module, the sync directives must be set to 0 in the ``etc/local_internal_options.conf`` file as shown below::

    wazuh_database.sync_agents=0
    wazuh_database.sync_syscheck=0
    wazuh_database.sync_rootcheck=0

Once these settings have been adjusted, save the file and **restart Wazuh**.  With the above settings, the Database Synchronization Module will not be loaded when Wazuh starts.

+-----------------------------------+---------------+---------------------------------------------------------------------------------+
|   **wazuh_database.sync_agents**  | Description   | Synchronize agent database with client.keys.                                    |
+                                   +---------------+---------------------------------------------------------------------------------+
|                                   | Default Value | 1                                                                               |
+                                   +---------------+---------------------------------------------------------------------------------+
|                                   | Allowed Value | 0, 1                                                                            |
+-----------------------------------+---------------+---------------------------------------------------------------------------------+
|  **wazuh_database.sync_syscheck** | Description   | Synchronize f.i.m. data with Syscheck database.                                 |
+                                   +---------------+---------------------------------------------------------------------------------+
|                                   | Default Value | 1                                                                               |
+                                   +---------------+---------------------------------------------------------------------------------+
|                                   | Allowed Value | 0, 1                                                                            |
+-----------------------------------+---------------+---------------------------------------------------------------------------------+
| **wazuh_database.sync_rootcheck** | Description   | Synchronize policy monitoring data with Rootcheck database.                     |
+                                   +---------------+---------------------------------------------------------------------------------+
|                                   | Default Value | 1                                                                               |
+                                   +---------------+---------------------------------------------------------------------------------+
|                                   | Allowed Value | 0, 1                                                                            |
+-----------------------------------+---------------+---------------------------------------------------------------------------------+
|    **wazuh_database.full_sync**   | Description   | Full data synchronization.                                                      |
+                                   +---------------+---------------------------------------------------------------------------------+
|                                   | Default Value | 0                                                                               |
+                                   +---------------+---------------------------------------------------------------------------------+
|                                   | Allowed Value | 0, 1                                                                            |
+-----------------------------------+---------------+---------------------------------------------------------------------------------+
|      **wazuh_database.sleep**     | Description   | Interval to sleep between cycles. Only necessary if inotify not available.      |
+                                   +---------------+---------------------------------------------------------------------------------+
|                                   | Default Value | 60                                                                              |
+                                   +---------------+---------------------------------------------------------------------------------+
|                                   | Allowed Value | Any integer from 0 to 86400 (seconds)Next,Previous                              |
+-----------------------------------+---------------+---------------------------------------------------------------------------------+

Wazuh_modules
-------------

+-----------------------------+---------------+-------------------------------------------------------------------+
| **wazuh_modules.task_nice** | Description   | Indicates the priority of the tasks. Lower Value, Higher priority |
+                             +---------------+-------------------------------------------------------------------+
|                             | Default Value | 10                                                                |
+                             +---------------+-------------------------------------------------------------------+
|                             | Allowed Value | Any integer                                                       |
+-----------------------------+---------------+-------------------------------------------------------------------+
|   **wazuh_modules.debug**   | Description   | Debug level                                                       |
+                             +---------------+-------------------------------------------------------------------+
|                             | Default Value | 0                                                                 |
+                             +---------------+-------------------------------------------------------------------+
|                             | Allowed Value | 0: No debug output                                                |
+                             +               +-------------------------------------------------------------------+
|                             |               | 1: Standard debug output                                          |
+                             +               +-------------------------------------------------------------------+
|                             |               | 2: Verbose debug outputNext,Previous                              |
+-----------------------------+---------------+-------------------------------------------------------------------+

Windows
-------

+----------------------------+---------------+--------------------------------------------------------------------------+
|      **windows.debug**     | Description   | Debug level (used in windows agent installations).                       |
+                            +---------------+--------------------------------------------------------------------------+
|                            | Default Value | 0                                                                        |
+                            +---------------+--------------------------------------------------------------------------+
|                            | Allowed Value | 0: No debug output                                                       |
+                            +               +--------------------------------------------------------------------------+
|                            |               | 1: Standard debug output                                                 |
+                            +               +--------------------------------------------------------------------------+
|                            |               | 2: Verbose debug outputNext,Previous                                     |
+----------------------------+---------------+--------------------------------------------------------------------------+
